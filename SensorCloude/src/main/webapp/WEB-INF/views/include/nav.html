<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<nav th:fragment="nav">
<div class="wrapper">
      <!--
            Tip 1: You can change the background color of the main header using: data-background-color="blue | purple | light-blue | green | orange | red"
      -->
      <div class="main-header" data-background-color="light-blue">
         <!-- Logo Header -->
         <div class="logo-header">
            
            <a href="/" class="logo">
               <img src="/resources/img/str.png" alt="navbar brand" class="navbar-brand">
            </a>
            <button class="navbar-toggler sidenav-toggler ml-auto" type="button" data-toggle="collapse" data-target="collapse" aria-expanded="false" aria-label="Toggle navigation">
               <span class="navbar-toggler-icon">
                  <i class="fa fa-bars"></i>
               </span>
            </button>
         
            </div>
         </div>
         <!-- End Logo Header -->
         <!-- Navbar Header -->
         <!-- <nav class="navbar navbar-header navbar-expand-lg">
            
            <div class="container-fluid">
            
               <ul class="navbar-nav topbar-nav ml-md-auto align-items-center">
                  <li class="nav-item toggle-nav-search hidden-caret">
                     <a class="nav-link" data-toggle="collapse" href="#search-nav" role="button" aria-expanded="false" aria-controls="search-nav">
                        <i class="fa fa-search"></i>
                     </a>
                  </li>
                  <li class="nav-item dropdown hidden-caret">
                     <a class="nav-link dropdown-toggle" href="#" id="messageDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-envelope"></i>
                     </a>
                  
                  </li>
                  <li class="nav-item dropdown hidden-caret">
                     <a class="nav-link dropdown-toggle" href="#" id="notifDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-bell"></i>
                        <span class="notification">4</span>
                     </a>
                     <ul class="dropdown-menu notif-box animated fadeIn" aria-labelledby="notifDropdown">
                        <li>
                           <div class="dropdown-title">You have 4 new notification</div>
                        </li>
                        <li>
                           <div class="notif-center">
                              <a href="#">
                                 <div class="notif-icon notif-primary"> <i class="fa fa-user-plus"></i> </div>
                                 <div class="notif-content">
                                    <span class="block">
                                       New user registered
                                    </span>
                                    <span class="time">5 minutes ago</span> 
                                 </div>
                              </a>
                              <a href="#">
                                 <div class="notif-icon notif-success"> <i class="fa fa-comment"></i> </div>
                                 <div class="notif-content">
                                    <span class="block">
                                       Rahmad commented on Admin
                                    </span>
                                    <span class="time">12 minutes ago</span> 
                                 </div>
                              </a>
                              <a href="#">
                                 <div class="notif-img"> 
                                    <img src="assets/img/profile2.jpg" alt="Img Profile">
                                 </div>
                                 <div class="notif-content">
                                    <span class="block">
                                       Reza send messages to you
                                    </span>
                                    <span class="time">12 minutes ago</span> 
                                 </div>
                              </a>
                              <a href="#">
                                 <div class="notif-icon notif-danger"> <i class="fa fa-heart"></i> </div>
                                 <div class="notif-content">
                                    <span class="block">
                                       Farrah liked Admin
                                    </span>
                                    <span class="time">17 minutes ago</span> 
                                 </div>
                              </a>
                           </div>
                        </li>
                        <li>
                           <a class="see-all" href="javascript:void(0);">See all notifications<i class="fa fa-angle-right"></i> </a>
                        </li>
                     </ul>
                  </li>
                  <li class="nav-item dropdown hidden-caret">
                     <a class="dropdown-toggle profile-pic" data-toggle="dropdown" href="#" aria-expanded="false">
                        <div class="avatar-sm">
                           <img src="assets/img/profile.jpg" alt="..." class="avatar-img rounded-circle">
                        </div>
                     </a>
                     <ul class="dropdown-menu dropdown-user animated fadeIn">
                        <li>
                           <div class="user-box">
                              <div class="avatar-lg"><img src="assets/img/profile.jpg" alt="image profile" class="avatar-img rounded"></div>
                              <div class="u-text">
                                 <h4>Hizrian</h4>
                                 <p class="text-muted">hello@example.com</p><a href="profile.html" class="btn btn-rounded btn-danger btn-sm">View Profile</a>
                              </div>
                           </div>
                        </li>
                        <li>
                           <div class="dropdown-divider"></div>
                           <a class="dropdown-item" href="#">My Profile</a>
                           <a class="dropdown-item" href="#">My Balance</a>
                           <a class="dropdown-item" href="#">Inbox</a>
                           <div class="dropdown-divider"></div>
                           <a class="dropdown-item" href="#">Account Setting</a>
                           <div class="dropdown-divider"></div>
                           <a class="dropdown-item" href="#">Logout</a>
                        </li>
                     </ul>
                  </li>
                  
               </ul>
            </div>
         </nav> -->
         <!-- End Navbar -->
      </div>
      <!-- Sidebar -->
      <div class="sidebar">
         
         <div class="sidebar-wrapper scrollbar-inner">
            <div class="sidebar-content">
               <div class="user">
                  <div class="avatar-sm float-left mr-2">
                     <img src="/resources/img/manager.svg" alt="..." class="avatar-img rounded-circle">
                  </div>
                  <div class="info">
                     <a data-toggle="collapse" href="#collapseExample" aria-expanded="true">
                        <span>
                           <p th:text="${session.name}"></p>
                           <p style="display:none;"class="nonid" th:text="${session.id}"></p>
                           <span class="user-level" th:switch="${session.mlevel}">
                            <span class="user-level" th:case="'1'">(권한없음)</span>
              			    <span class="user-level" th:case="'2'">(읽기권한)</span>
             			    <span class="user-level" th:case="'3'">(쓰기권한)</span>
              	  	  	    <span class="user-level" th:case="'4'">(수정권한)</span>
              			    <span class="user-level" th:case="'5'">(관리자)</span>
              			    <span class="user-level" th:case="'6'">(관리자)</span>
                           </span>
                           <span class="caret"></span>
                        </span>
                     </a>
                     <div class="clearfix"></div>

                     <div class="collapse in" id="collapseExample">
                        <ul class="nav">
                           <li>
                              <a href="/mypage/1">
                                 <span class="link-collapse">내 점검이력</span>
                              </a>
                           </li>
                           <li>
                              <a href="#edit">
                                 <span class="link-collapse">정보수정</span>
                              </a>
                           </li>
                           <li>
                              <a href="#settings">
                                 <span class="link-collapse">승급요청</span>
                              </a>
                           </li>
                           <li>
                              <a href="/logout">
                                 <span class="link-collapse">로그아웃</span>
                              </a>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <ul class="nav">
                  <li class="nav-item">
                     <a href="/">
                     <i class="fas fa-home"></i>
                        <p>홈</p>
                     </a>
                  </li>

                  <li class="nav-section">
                     <span class="sidebar-mini-icon">
                        <i class="fa fa-ellipsis-h"></i>
                     </span>
                     <h4 class="text-section">메  뉴</h4>
                  </li>

                  <li class="nav-item">
                     <a href="/sitelist/1">
                        <i class="fas fa-map-marker-alt"></i>
                        <p>현장관리</p>
                        
                     </a>   
                  </li>

                  <li class="nav-item">
                     <a href="/check/1">
                        <i class="fas fa-pen-square"></i>
                        <p>점검이력</p>
                     </a>
                  </li>

                  <li class="nav-item">
                     <a href="/time/1">
                        <i class="fas fa-table"></i>
                        <p>타임라인</p>
                     </a>
                  </li>

                  <li class="nav-item">
                     <a href="/mysensor/1">
                       <i class="fas fa-microchip"></i>
                        <p>보유센서</p>
                     </a>
                  </li>

              
                  
                  <li class="nav-item">
                     <a data-toggle="collapse" href="#custompages">
                       <i class="fas fa-cog"></i>
                        <p>관리</p>
                        <span class="caret"></span>
                     </a>
                     <div class="collapse" id="custompages">
                        <ul class="nav nav-collapse">
                           <li>
                              <a href="/manage/1">
                                 <span class="sub-item">사용자관리</span>
                              </a>
                           </li>
                           <li>
                              <a href="/adminCheckPage/1/1/1">
                                 <span class="sub-item">점검이력관리</span>
                              </a>
                           </li>
                           <li>
                              <a href="/company/1">
                                 <span class="sub-item">협력사관리</span>
                              </a>
                           </li>
                          
                        </ul>
                     </div>
                  </li>
               </ul>
            </div>
         </div>
      </div>
</nav>
<script>
var user_id = $(".nonid").text();


$.getJSON("/mypage/getAttachListmypage",{user_id : user_id},function(arr){
	   console.log(arr);
	   
	   var str = "";
		 
		 $(arr).each(function(i, attach){
			//image type
			if(attach.filetype){
				var fileCallPath = encodeURIComponent( attach.file_path+ "/s_"+attach.uuid + "_"+attach.file_name);
				console.log(fileCallPath);
				str += "<li class='delete' data-path='"+attach.file_path+"' data-uuid='"+attach.uuid+"' data-filename='"+attach.file_name+"' data-type='"+attach.filetype+"' ><div>";
				str += "<img class='delete1' src='/display?fileName="+fileCallPath+"'>";
				str += "</div>";
				str += "</li>";
			
			} else {
				str += "<img src='/resources/img/manager.svg'>";
				
			}
			 
		 });
		 
		 $(".avatar-img").attr("src",str);
		
	 }); //end getjson
</script>
</html>