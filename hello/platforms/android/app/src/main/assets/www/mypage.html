<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
    <title>마이페이지</title>
    <link rel="stylesheet" type="text/css" href="./css/jquery.mobile-1.4.5.css" />
    <link rel="stylesheet" type="text/css" href="./css/mypage.css" />
    <link rel="stylesheet" type="text/css" href="./css/mpmodify.css" />
    <script src="./js/jquery.js"></script>
    <script src="./js/jquery.mobile-1.4.5.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

   <script>
    $(document).ready(function() {
      $.ajax({
         type : "POST",
         url : "http://39.127.7.60:8080/app/mypage",
         contentType : "application/json; charset=UTF-8",
         success : function(result){
               console.log(result)
               var str = "";
               $.each(result,function(i,s){
               str +='<tr>';
               str +='<td>'+s.site_name+'</td>';      // 현장이름
               str +='<td>'+s.title+'</td>';          // 제목
               str +='<td>'+s.board_status+'</td>';   // 상태
               str +='<td>'+s.reg_date+'</td>';       // 날짜
               str +='</tr>';

               $("#mypagechecklist").html(str);
            });
            
         function pagination(){
         var req_num_row=5;
         var $tr=jQuery('tbody tr');
         var total_num_row=$tr.length;
         var num_pages=0;
         if(total_num_row % req_num_row ==0){
               num_pages=total_num_row / req_num_row;
         }
         if(total_num_row % req_num_row >=1){
               num_pages=total_num_row / req_num_row;
               num_pages++;
               num_pages=Math.floor(num_pages++);
         }
   
      jQuery('.pagination').append("<li><a class=\"prev\"><</a></li>");
   
         for(var i=1; i<=num_pages; i++){
               jQuery('.pagination').append("<li><a>"+i+"</a></li>");
         jQuery('.pagination li:nth-child(2)').addClass("active");
         jQuery('.pagination a').addClass("pagination-link");
         }
   
      jQuery('.pagination').append("<li><a class=\"next\">></a></li>");
   
         $tr.each(function(i){
         jQuery(this).hide();
         if(i+1 <= req_num_row){
                  $tr.eq(i).show();
               }
         });
   
         jQuery('.pagination a').click('.pagination-link', function(e){
               e.preventDefault();
               $tr.hide();
               var page=jQuery(this).text();
               var temp=page-1;
               var start=temp*req_num_row;
         var current_link = temp;
         
         jQuery('.pagination li').removeClass("active");
               jQuery(this).parent().addClass("active");
      
               for(var i=0; i< req_num_row; i++){
                  $tr.eq(start+i).show();
               }
         
         if(temp >= 1){
         jQuery('.pagination li:first-child').removeClass("disabled");
         }
         else {
         jQuery('.pagination li:first-child').addClass("disabled");
         }
               
         });
   
      jQuery('.prev').click(function(e){
         $("<li><a class=\"prev\">Previous</a></li>").bind('click', {newPage: page},function(event) {
            if(num_pages == 0) return; 
            num_pages = num_pages-1;
            $tr.trigger('repaginate'); 

         $($(".pageNum")[(num_pages-nowp)+2]).addClass('active').siblings().removeClass('active');
         }).appendTo(pagination).addClass('clickable');
      });
   
      jQuery('.next').click(function(e){
         e.preventDefault();
         jQuery('.pagination li:last-child').removeClass("active");
      });
   
      }
   
   jQuery('document').ready(function(){
      pagination();
   
   jQuery('.pagination li:first-child').addClass("disabled");
   
   });

            } // success 함수 종
      }); // ajax함수

      $('.update').on('click', function() {
         $("#contents").load("modify.html");
      });
   

    });
   </script>
</head>
<body>
   <div data-role="page">
    <div data-role="header"  data-position="fixed">
        <a data-iconpos="notext" data-role="button" data-icon="home" title="Home" style="display: none;">Home</a>
        <img src="./img/str.png" width="30%" height="30%">
        <a data-iconpos="notext" href="#panel" data-role="button" data-icon="bars" style="margin-top: 10px"></a>
    </div>

    <div data-role="content">
        <div data-role="tabs">
            <div class="cell" >
                <img src="./img/user.png" id="img" width="80px" height="80px">
            </div>

            <div class="name01">
                <p class="n1">김개발</p>
                <p class="n2">등급 5</p>
            </div>

            <div data-role="navbar" >
                    <ul>
                        <li><a href="#tab1">로그아웃</a></li>
                        <li><a href="#tab2">정보수정</a></li>
                    </ul>               
        </div>

        <div id="tab1">
            <div class="title-header">
                <h1>나의 점검이력</h1>             
            </div>
           
            <table>
                <thead>
                    <tr>
                        <th scope="col" style="width:9%;">현장이름</th>
                        <th scope="col" style="width:10%;">제목</th>
                        <th scope="col" style="width:5%;">상태</th>
                        <th scope="col" style="width:6%;">날짜</th>
                    </tr>
                </thead>
                <tbody id="mypagechecklist">
                    
                </tbody>
            </table>
        
            <nav class="pagination-container">
                <div class="pagination">
                      
                </div>
            </nav>
            
        </div>


        <div id="tab2">
            <div class="wrapperr">
                <h2>개인정보 수정</h2>
                <div class="usermodify-card">
                    <h3>비밀번호</h3>
                    <input type="password" name="pass" id="pass" placeholder="Password"> <br>		
                    <input type="button" name="confirm" id="confirm-modify" class="mpmodify-submit" value="확인">
                </div>
      
                  <input type="button" name="confirm" id="levelp" class="mpmodify-submit" value="승급요청" />
            </div>
        </div>

        </div>

    </div>
 
    <div data-role="footer"  data-position="fixed" data-id="footerid1">
        <div data-role="navbar">
            <ul>
              <li><a href="main.html" rel="external" data-icon="home"></a></li>
              <li><a href="push.html" rel="external" data-icon="search"></a></li>
              <li><a href="timeline.html" rel="external" data-icon="comment"></a></li>
              <li><a href="mypage.html" rel="external" data-icon="user"></a></li>
            </ul>
        </div>
    </div>

</div>
 

</body>
</html>