<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
    <title>마이페이지</title>
    <link rel="stylesheet" type="text/css" href="./css/jquery.mobile-1.4.5.css" />
    <link rel="stylesheet" type="text/css" href="./css/mypage.css" />
    <link rel="stylesheet" type="text/css" href="./css/mpmodify.css" />
    <link rel="stylesheet" type="text/css" href="./css/level.css" />
    <script src="./js/jquery.js"></script>
    <script src="./js/jquery.mobile-1.4.5.js"></script>    
    <script src="./js/mypage.js"></script>
    <script src="./js/level.js"></script>

   <script>
    $(document).ready(function() {
      $.ajax({
         type : "POST",
         url : "http://39.127.7.58:8080/app/mypage",
         data : {pagenum : 1},
         success : function(result){
               console.log(result)
               var page="";
               var str = "";  
               $.each(result.mpcheckList,function(i,s){
               str +='<tr>';
               str +='<td>'+s.site_name+'</td>';      // 현장이름
               str +='<td>'+s.title+'</td>';          // 제목
               str +='<td>'+s.board_status+'</td>';   // 상태
               str +='<td>'+s.reg_date+'</td>';       // 날짜
               str +='</tr>';

               $("#mypagechecklist").html(str);
                  
            });
                 if (result.criteria.prev) {
                     page += '<li class="page-item"><a class="page-link" href="javascript:page(' + (result.criteria.startPage - 1) + ');" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a></li>'
                  }
                  for (var i = result.criteria.startPage; i <= result.criteria.endPage; i++) {
                     page += '<li class="page-item"><a class="page-link" href="javascript:page(' + i + ');">' + i + '</a></li>'
                  }
                  if (result.criteria.next) {
                     page += '<li class="page-item"><a class="page-link" href="javascript:page(' + (result.criteria.endPage + 1) + ');" aria-label="Next"><span aria-hidden="true">&raquo;</span></a></li>'
                  }
                  $(".pagination").empty();
                  $(".pagination").prepend(page);
                  $("html, body").animate({ scrollTop: 0 }, 1);
           
            
            } // success 함수 종
      }); // ajax함수

      $('.mpmodify-level').on('click', function() {
         $("#content").load("usermodify.html");
      });

    });

    function page(index) {
    $.ajax({
         type : "POST",
         url : "http://39.127.7.58:8080/app/mypage",
         data : {pagenum : index},
         success : function(result){
               console.log(result)
               var page="";
               var str = ""; 
               $.each(result.mpcheckList,function(i,s){
               str +='<tr>';
               str +='<td>'+s.site_name+'</td>';      // 현장이름
               str +='<td>'+s.title+'</td>';          // 제목
               str +='<td>'+s.board_status+'</td>';   // 상태
               str +='<td>'+s.reg_date+'</td>';       // 날짜
               str +='</tr>';

               $("#mypagechecklist").html(str);
                  
            });
                 if (result.criteria.prev) {
                     page += '<li class="page-item"><a class="page-link" href="javascript:page(' + (result.criteria.startPage - 1) + ');" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a></li>'
                  }
                  for (var i = result.criteria.startPage; i <= result.criteria.endPage; i++) {
                     page += '<li class="page-item"><a class="page-link" href="javascript:page(' + i + ');">' + i + '</a></li>'
                  }
                  if (result.criteria.next) {
                     page += '<li class="page-item"><a class="page-link" href="javascript:page(' + (result.criteria.endPage + 1) + ');" aria-label="Next"><span aria-hidden="true">&raquo;</span></a></li>'
                  }
                  $(".pagination").empty();
                  $(".pagination").prepend(page);
                  $("html, body").animate({ scrollTop: 0 }, 1);
            
            
            } // success 함수 종
      }); // ajax함수
   }
   </script>
</head>
<body>
   <div data-role="page">
    <div data-role="header"  data-position="fixed">
        <a data-iconpos="notext" data-role="button" data-icon="home" title="Home" style="display: none;">Home</a>
        <img src="./img/str.png" width="30%" height="30%">
        <a data-iconpos="notext" href="#panel" data-role="button" data-icon="bars" style="margin-top: 10px"></a>
    </div>

    <div data-role="content">
        <div data-role="tabs">
            <div class="cell" >
                <img src="./img/user.png" id="img" width="80px" height="80px">
            </div>

            <div class="name01">
                <p class="n1">김개발</p>
                <p class="n2">등급 5</p>
            </div>

            <div data-role="navbar" >
               <ul>
                  <li><a href="#tab1">메인</a></li>
                  <li><a href="#">로그아웃</a></li>
                  <li><a href="#tab2">정보수정</a></li>
               </ul>               
            </div>

        <div id="tab1">
            <div class="title-header">
                <h1>나의 점검이력</h1>             
            </div>
           
            <table>
                <thead>
                    <tr>
                        <th scope="col" style="width:9%;">현장이름</th>
                        <th scope="col" style="width:10%;">제목</th>
                        <th scope="col" style="width:5%;">상태</th>
                        <th scope="col" style="width:6%;">날짜</th>
                    </tr>
                </thead>
                <tbody id="mypagechecklist">
                    
                </tbody>
            </table>
        
            <nav class="pagination-container">
                <div class="pagination">
                      
                </div>
            </nav>
            
        </div>


        <div id="tab2">
            <div class="wrapperr">
                <h2>개인정보 수정</h2>
                <div class="usermodify-card">
                    <h3>비밀번호</h3>
                    <input type="password" name="pass" id="pass" placeholder="Password"> <br>		
                    <input type="button" name="confirm" id="confirm-modify" class="mpmodify-submit" value="확인">
                </div>
      
                <a data-rel="popup" href="#levelpop" class="ui-btn ui-btn-b">승급요청</a>

                <div data-role="popup" id="levelpop">      
                  <center><h2>승급요청</h2></center>

                  <div id="levelcontent">
                     <div id="now-level">      
                        <p>현재 김개발 님의 등급은 5등급 입니다.</p>
                           
                        <!-- <p th:text="${userInfo.user_id}" id="user_id" style="display: none"></p>
                           승급요청시 사용자 관리에 id를 넘기기위함 -->
                     </div>
                     
                     <div id="next-level">
                        <select id="select_level">
                           <option value="1">1. 권한없음</option>
                           <option value="2">2. 읽기권한</option>
                           <option value="3">3. 쓰기권한</option>
                           <option value="4">4. 수정권한</option>
                           <option value="5">5. 관리자</option>
                        </select>
                        <p>으로</p>
                     </div>
                     <p style="margin-left: 18%">승급 요청 하시겠습니까?</p>
                     
                  </div>
      
                  <input type="button" id="ok" value="확인" />
                  
               </div>
                
            </div>
         </div>

        </div>

    </div>
 
    <div data-role="footer"  data-position="fixed" data-id="footerid1">
        <div data-role="navbar">
            <ul>
                    <li><a href="main.html" rel="external" data-icon="home"></a></li>
                    <li><a href="search.html" rel="external" data-icon="search"></a></li>
                    <li><a href="push.html" rel="external" data-icon="comment"></a></li>
                    <li><a href="mypage.html" rel="external" data-icon="user"></a></li>
            </ul>
        </div>
    </div>

</div>
 

</body>
</html>